<html>
    <head>
        <title>Helper -> ToC</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-slate-200">
        <div class="grid place-items-center h-screen">
            <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                <div class="mb-4">
                    <label for="start" class="block text-gray-700 text-sm font-bold mb-2">String to convert:</label>
                    <input type="text" id="start" name="start" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <button type="button" onclick="replaceSpace()" class="mt-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Generate ToC</button>
                </div>
                <div class="mb-4">
                    <div id="result-wrap" style="display:none;">
                        <p id="result"></p>
                        <button onclick="copy()" class="mt-2 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Copy</button>
                        <button onclick="addHash()" class="mt-2 bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Add #</button>
                    </div>
                </div>
            </div>
        </div>
        <script> 
            // not ideal but works for most of cases
            function replaceAllExceptFirst(str, search, replace) {
                return str.split(search).reduce((prev, curr, i) => prev + (i == 1 ? search : replace) + curr);
            }

            const replaceSpace = () =>{
                let str = document.getElementById("start").value; 
                var x = document.getElementById("result-wrap");

                x.style.display = "none";

                // check if # is in str (dont look first char) and delete it
                str = replaceAllExceptFirst(str, '#', '');

                // check if length>50 and abort
                if(str.length > 50) return false;

                str = str.trim();
                str = str.replace("'", "");
                str = str.replace(/\s+/g, '-');

                // delete leftover '-' at the end if we had to delete '
                if(str.charAt(str.length-1) == '-') {
                    str = str.slice(0, -1);
                }

                // show copy button after results if str is not empty
                if(x.style.display === "none" && str) {
                    x.style.display = "block";    
                }                 

                document.getElementById("result").innerHTML = str;
            }

            // copy to the clipboard
            const copy = () =>{
                const cb = navigator.clipboard;
                const paragraph = document.querySelector('p');
                cb.writeText(paragraph.innerText);
            }

            // add # at the beginning
            const addHash = () =>{
                var toHash = document.getElementById("result").innerHTML;

                // add only if # isn't first char
                if(toHash.charAt(0) != '#') {
                    toHash = "#" + toHash;
                }

                document.getElementById("result").innerHTML = toHash;
            }
        </script>
    </body>
</html>